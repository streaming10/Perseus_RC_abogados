<!-- Scripts optimizados -->
<script>
// Smooth scrolling para enlaces de navegación
document.addEventListener('DOMContentLoaded', function() {
  // Smooth scrolling
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href'));
      if (target) {
        target.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
      }
    });
  });

  // Header transparency on scroll
  let ticking = false;
  function updateHeader() {
    const header = document.querySelector('.header');
    if (window.scrollY > 100) {
      header.style.background = 'rgba(255, 255, 255, 0.98)';
      header.style.backdropFilter = 'blur(30px)';
    } else {
      header.style.background = 'rgba(255, 255, 255, 0.95)';
      header.style.backdropFilter = 'blur(20px)';
    }
    ticking = false;
  }

  window.addEventListener('scroll', function() {
    if (!ticking) {
      requestAnimationFrame(updateHeader);
      ticking = true;
    }
  });

  // Intersection Observer para animaciones
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -80px 0px'
  };

  const observer = new IntersectionObserver(function(entries) {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
      }
    });
  }, observerOptions);

  document.querySelectorAll('.fade-in').forEach(el => {
    observer.observe(el);
  });

  // Parallax effect para hero (optimizado)
  let heroParallaxTicking = false;
  const hero = document.querySelector('.hero');
  
  function updateParallax() {
    const scrolled = window.pageYOffset;
    if (hero && scrolled < window.innerHeight) {
      hero.style.transform = `translateY(${scrolled * 0.3}px)`;
    }
    heroParallaxTicking = false;
  }

  window.addEventListener('scroll', function() {
    if (!heroParallaxTicking) {
      requestAnimationFrame(updateParallax);
      heroParallaxTicking = true;
    }
  });

  // Mobile menu toggle - VERSIÓN MEJORADA
  const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
  const navMenu = document.querySelector('.nav-menu');
  const body = document.body;
  
  console.log('Mobile menu elements:', { mobileMenuBtn, navMenu }); // Debug
  
  if (mobileMenuBtn && navMenu) {
    mobileMenuBtn.addEventListener('click', function(e) {
      e.preventDefault();
      e.stopPropagation();
      
      console.log('Mobile menu clicked'); // Debug
      
      // Toggle clases
      const isActive = navMenu.classList.contains('mobile-active');
      
      if (isActive) {
        navMenu.classList.remove('mobile-active');
        mobileMenuBtn.classList.remove('active');
        body.classList.remove('menu-open');
        mobileMenuBtn.setAttribute('aria-expanded', 'false');
      } else {
        navMenu.classList.add('mobile-active');
        mobileMenuBtn.classList.add('active');
        body.classList.add('menu-open');
        mobileMenuBtn.setAttribute('aria-expanded', 'true');
      }
    });
    
    // Cerrar menú al hacer click en un enlace
    const navLinks = navMenu.querySelectorAll('.nav-link');
    navLinks.forEach(link => {
      link.addEventListener('click', function() {
        navMenu.classList.remove('mobile-active');
        mobileMenuBtn.classList.remove('active');
        body.classList.remove('menu-open');
        mobileMenuBtn.setAttribute('aria-expanded', 'false');
      });
    });
    
    // Cerrar menú con escape
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && navMenu.classList.contains('mobile-active')) {
        navMenu.classList.remove('mobile-active');
        mobileMenuBtn.classList.remove('active');
        body.classList.remove('menu-open');
        mobileMenuBtn.setAttribute('aria-expanded', 'false');
      }
    });
    
    // Cerrar menú al hacer click fuera
    document.addEventListener('click', function(e) {
      if (!navMenu.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
        if (navMenu.classList.contains('mobile-active')) {
          navMenu.classList.remove('mobile-active');
          mobileMenuBtn.classList.remove('active');
          body.classList.remove('menu-open');
          mobileMenuBtn.setAttribute('aria-expanded', 'false');
        }
      }
    });
  } else {
    console.error('Mobile menu elements not found:', { mobileMenuBtn, navMenu });
  }
});

// Service Worker para PWA
if ('serviceWorker' in navigator && location.protocol === 'https:') {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/sw.js');
  });
}
</script>
